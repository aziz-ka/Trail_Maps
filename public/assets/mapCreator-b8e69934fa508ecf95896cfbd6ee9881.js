function trailCoords(a,t){var e=[a,t];newTrailCoords.push(e)}function initialize(){$("#create-trail-form-div").hide();var a={zoom:4,center:centerOfUS,scaleControl:!0};map=new google.maps.Map(document.getElementById("map-trail"),a),setEventHandlers()}function setTrailDrawing(){poly=new google.maps.Polyline(polyOptions),trails.push(poly),poly.setMap(map),google.maps.event.addListener(map,"click",addLatLng)}function addLatLng(a){var t=poly.getPath();lichard=t,t.push(a.latLng),trailCoords(a.latLng.k,a.latLng.A);var e=new google.maps.Marker({position:a.latLng,title:"#"+t.getLength(),map:map});markers.push(e)}function makeTrail(){var a={};return a.title=$(".create-trail-title").val(),a.description=$(".create-trail-description").val(),a.state=$(".create-trail-state").val(),a.coords=newTrailCoords,a}function setEventHandlers(){liClick(),createTrailClick(),trailFormClick(),clearButtonClick()}function removeFromMap(a){$(a).each(function(a,t){t.setMap(null)})}function clearMap(){removeFromMap(markers),removeFromMap(trails)}function liClick(){$(".trail").on("click",function(){$(".trail-info").html(""),$(".add-notes-here").show(),$(".add-notes").show(),$("#create-trail-form-div").hide();var a=$(this).data("coords"),t=$(this).data("title"),e=$(this).data("state"),i=$(this).data("description"),r=$(this).data("trail-id");$(".trail-info").append("<li><b>Title:</b>"+t+"</li>"),$(".trail-info").append("<li><b>State:</b>"+e+"</li>"),$(".trail-info").append("<li><b>Description:</b>"+i+"</li>"),$(".trail-info").attr("data-trail-id",r),clearMap(),getNotes();var l=[a[0],a[a.length-1]];$(l).each(function(a){var t=new google.maps.LatLng(l[a][0],l[a][1]),e=new google.maps.Marker({position:t,map:map});markers.push(e)});var o=[];$(a).each(function(t){var e=a[t],i=new google.maps.LatLng(e[0],e[1]);o.push(i)});var n=new google.maps.Polyline({path:o,strokeColor:"#f00",strokeOpacity:.7,strokeWeight:5});n.setMap(map),trails.push(n)})}function createTrailClick(){$(".create-trail-button").on("click",function(a){a.preventDefault();{var t=makeTrail();$(".current-user-id").val()}$.ajax({url:"/trails",method:"post",dataType:"json",data:{trail:t},success:function(a){var t=new TrailModel(a);if(lichard=t,null!=t.id){var e=$("<li>");e.attr("class","trail").attr("data-trail-id",t.id).attr("data-state",t.state).attr("data-title",t.title).data("coords",t.coords).attr("data-description",t.description).text(t.title),$(".trails").append(e),liClick(),clearMap(),clearFields(),$("#create-trail-form-div").hide(),alert("You have successfully created a trail! check out your list to review/make notes!")}else alert("YouYour trail was not created! Fill out all fields and draw a trail to make one!")}})})}function clearFields(){$(".create-trail-title").val(""),$(".create-trail-state").val(""),$(".create-trail-description").val("")}function trailFormClick(){$(".trail-form-button").on("click",function(){setTrailDrawing(),newTrailCoords=[],$(".add-notes-here").hide(),$(".add-notes").hide(),clearMap(),$("#create-trail-form-div").show()})}function clearButtonClick(){$(".clear-button").on("click",function(){newTrailCoords=[],clearMap(),clearFields()})}var newTrailCoords=[],centerOfUS=new google.maps.LatLng(39.8104,-96.556),poly,map,polyOptions={strokeColor:"#000000",strokeOpacity:1,strokeWeight:3};google.maps.event.addDomListener(window,"load",initialize);var markers=[],trails=[];$(".add-notes-here").hide(),$(".add-notes").hide();